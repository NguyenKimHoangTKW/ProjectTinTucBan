@model ProjectTinTucBan.Models.BaiViet
@{
}
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <title>@ViewBag.Title</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- Tailwind CSS -->
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet" />
    <!-- Swiper CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css" />
    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet" />
    <style>
        html, body {
            margin: 0;
            padding: 0;
            overflow-x: hidden;
            scroll-behavior: smooth;
        }
        .animate-pulse {
    animation: pulse 2s infinite;
}
.animate-bounce {
    animation: bounce 1s infinite;
}

@@keyframes pulse {
    0%, 100% { opacity: 1 }
    50% { opacity: 0.5 }
}

@@keyframes bounce {
    0%, 100% { transform: translateY(0) }
    50% { transform: translateY(-5px) }
}

            /* Thu nhỏ scrollbar */
            body::-webkit-scrollbar {
                width: 6px;
            }

            body::-webkit-scrollbar-thumb {
                background-color: rgba(0, 0, 0, 0.2);
                border-radius: 4px;
            }

        body {
            scrollbar-width: thin;
            scrollbar-color: rgba(0, 0, 0, 0.2) transparent;
        }

        /* Swiper điều hướng */
        .swiper-button-prev,
        .swiper-button-next {
            color: white;
            width: 40px;
            height: 40px;
            background-color: rgba(0, 0, 0, 0.4);
            border-radius: 9999px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
            top: 50%;
            transform: translateY(-50%);
            transition: background-color 0.3s;
        }

            .swiper-button-prev:hover,
            .swiper-button-next:hover {
                background-color: rgba(0, 0, 0, 0.6);
            }

            .swiper-button-prev::after,
            .swiper-button-next::after {
                font-size: 20px;
                font-weight: bold;
            }

        .swiper-button-prev {
            left: 16px;
        }

        .swiper-button-next {
            right: 16px;
        }

        .swiper {
            width: 100vw;
            height: 600px;
        }

        .swiper-slide img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            border-radius: 0;
        }

        .line-clamp-2 {
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        img, iframe {
            max-width: 100%;
            height: auto;
        }

        .swiper-pagination-bullet {
            width: 30px;
            height: 4px;
            background: rgba(255, 255, 255, 0.5);
            opacity: 1;
            margin: 0 4px !important;
            border-radius: 0;
            transition: background 0.3s;
        }

        .swiper-pagination-bullet-active {
            background: white;
        }
    </style>
</head>
<body class="bg-gray-50 text-gray-800">
    <!-- Banner -->
    <section class="w-full relative">
        <div class="swiper mySwiper w-full h-[400px] overflow-hidden relative">
            <div class="swiper-wrapper" id="slider-container">
                <!-- Dữ liệu ảnh sẽ được load từ API -->
            </div>
            <div class="swiper-button-prev"></div>
            <div class="swiper-button-next"></div>
            <div class="swiper-pagination"></div>
        </div>
    </section>

    <!-- Tin tức -->
    <section class="py-10">
        <div class="max-w-7xl mx-auto grid grid-cols-1 md:grid-cols-4 gap-6">
            <!-- Cột nội dung chính -->
            <div class="md:col-span-3 space-y-12" id="mucLucContainer"></div>

            <!-- Cột sidebar bên phải -->
            <aside class="space-y-6" id="sidebar-khoi-donvi">
                <!-- Nội dung Khối và Đơn vị sẽ được load bằng JavaScript -->
            </aside>
        </div>
    </section>    <!-- Scripts -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>
    <script>
        function toSlug(str) {
            return str.toLowerCase().normalize("NFD").replace(/\p{Diacritic}/gu, '').replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)+/g, '');
        }

        function formatDate(yyyymmdd) {
            if (!yyyymmdd || yyyymmdd.toString().length !== 8) return '';
            const str = yyyymmdd.toString();
            return `${str.substring(6, 8)}/${str.substring(4, 6)}/${str.substring(0, 4)}`;
        }

        // Hàm chuyển Unix timestamp sang "dd/MM/yyyy"
        function unixToDateStr(unix) {
            if (!unix || isNaN(unix)) return '';
            var d = new Date(unix * 1000);
            var day = ('0' + d.getDate()).slice(-2);
            var month = ('0' + (d.getMonth() + 1)).slice(-2);
            var year = d.getFullYear();
            return day + '/' + month + '/' + year;
        }

        new Swiper(".mySwiper", {
            loop: true,
            autoplay: { delay: 3000, disableOnInteraction: false },
            pagination: { el: ".swiper-pagination", clickable: true },
            navigation: { nextEl: ".swiper-button-next", prevEl: ".swiper-button-prev" }
        });

        // Lưu trữ dữ liệu mục lục bài viết
        window.mucLucData = {};

        $(document).ready(function () {
            // Đọc dữ liệu footer từ API thay vì file JSON
            fetch('/api/FooterApi/1')  // Giả sử ID của footer là 1
                .then(response => response.json())
                .then(data => {
                    document.getElementById('video').src = data.VideoUrl;
                    document.getElementById('fullName').textContent = data.FullName;
                    document.getElementById('englishName').innerHTML = data.EnglishName.replaceAll(',', '<br>');
                    // Sửa tại đây: chuyển Unix timestamp sang ngày
                    document.getElementById('established').textContent = unixToDateStr(data.NgayThanhLap);
                    document.getElementById('address').textContent = data.DiaChi;
                    document.getElementById('phone').textContent = data.DienThoai;
                    document.getElementById('email').textContent = data.Email;
                    document.getElementById('email').href = 'mailto:' + data.Email;
                    document.getElementById('footerCopyright').textContent = data.FooterCopyright || "";
                    document.getElementById('footerNote').textContent = data.FooterNote || "";

                    // Lưu VideoUrl để sử dụng cho popupVideo
                    let videoUrl = data.VideoUrl;

                    // Xử lý play video khi nhấn "Watch Video" (hiện popup)
                    document.getElementById('btnWatchVideo').addEventListener('click', function (e) {
                        e.preventDefault();
                        var modal = document.getElementById('videoModal');
                        var popupVideo = document.getElementById('popupVideo');
                        var url = videoUrl;
                        if (!url.includes('autoplay=1')) {
                            url += (url.includes('?') ? '&' : '?') + 'autoplay=1';
                        }
                        popupVideo.src = url;
                        modal.classList.remove('hidden');
                    });
                });

            // Đóng modal khi nhấn nút đóng
            document.getElementById('closeVideoModal').addEventListener('click', function () {
                var modal = document.getElementById('videoModal');
                var popupVideo = document.getElementById('popupVideo');
                modal.classList.add('hidden');
                popupVideo.src = "";
            });

            // Đóng modal khi click ra ngoài nội dung
            document.getElementById('videoModal').addEventListener('click', function (e) {
                if (e.target === this) {
                    this.classList.add('hidden');
                    document.getElementById('popupVideo').src = "";
                }
            });

            // Xử lý chuyển hướng khi nhấn "CHI TIẾT"
            document.getElementById('btnChiTiet').addEventListener('click', function (e) {
                e.preventDefault();
                window.open('https://bdbcl.tdmu.edu.vn/danh-muc/Gioi-thieu/gioi-thieu-chung', '_blank');
            });
    </script>
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.js"></script>

    <script src="~/Scripts/Scripts/BaiVietTrangChu.js"></script>
    <footer class="bg-[#29A3E0] text-white text-sm py-6">
        <div class="max-w-7xl mx-auto px-4 space-y-2 text-center sm:text-left">
            <p id="footerCopyright"></p>
            <p id="footerNote"></p>
        </div>
    </footer>
</body>
</html>